<!DOCTYPE html> 
<html lang="ru"> 
<head> 
    <meta charset="UTF-8" /> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /> 
    <meta http-equiv="X-UA-Compatible" content="ie=edge" /> 
    <title>–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–∏–∫–∞</title> 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> 
    <style> 
        /* ========================================================== */ 
        /* –§–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç–∏–ª–∏–∑–∞—Ü–∏—è "The Golden Spoon" */ 
        /* ========================================================== */ 
        :root { 
            /* –û–ª–∏–≤–∫–æ–≤–æ-–∑–æ–ª–æ—Ç–∞—è –≥–∞–º–º–∞ */ 
            --primary-color: #8C7851; /* –¢–µ–ø–ª—ã–π –æ–ª–∏–≤–∫–æ–≤–æ-–∑–æ–ª–æ—Ç–æ–π (–¥–ª—è –∫–Ω–æ–ø–æ–∫) */ 
            --secondary-color: #E2D2B0; /* –°–≤–µ—Ç–ª—ã–π –∑–æ–ª–æ—Ç–∏—Å—Ç—ã–π (–¥–ª—è –∞–∫—Ü–µ–Ω—Ç–æ–≤) */ 
            --bg-dark: #2A3131; /* –û—á–µ–Ω—å —Ç–µ–º–Ω—ã–π —Ñ–æ–Ω */ 
            --bg-medium: #3E4646; /* –§–æ–Ω –¥–ª—è –∫–∞—Ä—Ç–æ—á–∫–∏ –∫–∞—Ä—Ç—ã */ 
            --text-main: #FFFFFF; 
            --table-free: #5D6D7E; /* –°–µ—Ä—ã–π/–°–≤–µ—Ç–ª–æ-—Å–∏–Ω–∏–π –¥–ª—è —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤ */ 
            --table-selected: #8C7851; /* –í—ã–±—Ä–∞–Ω–Ω—ã–π —Å—Ç–æ–ª - –∑–æ–ª–æ—Ç–∏—Å—Ç—ã–π */ 
            --table-booked: #B54646; /* –ó–∞–Ω—è—Ç—ã–π —Å—Ç–æ–ª - –±–æ—Ä–¥–æ–≤—ã–π */ 

            /* Telegram Theme Adaptation */ 
            color-scheme: dark;  
        } 

        body { 
            margin: 0; 
            padding: 0; 
            font-family: 'Times New Roman', serif; 
            background-color: var(--bg-dark); 
            color: var(--text-main); 
            box-sizing: border-box; 
            display: flex; 
            flex-direction: column; 
            min-height: 100vh; 
        } 

        /* ----- –ó–∞–≥–æ–ª–æ–≤–æ–∫ ----- */ 
        .header-section { 
            background-color: var(--bg-dark); 
            padding: 20px 0 15px; 
            text-align: center; 
            color: var(--secondary-color); 
        } 

        .header-title { 
            font-family: 'Times New Roman', serif; 
            font-size: 28px; 
            margin: 0; 
            font-weight: bold; 
        } 

        .header-subtitle { 
            font-size: 14px; 
            margin-top: 5px; 
            letter-spacing: 1px; 
            color: var(--secondary-color); 
        } 

        /* ----- –ë–ª–æ–∫ –≤—ã–±–æ—Ä–∞ (–î–∞—Ç–∞/–í—Ä–µ–º—è/–ì–æ—Å—Ç–∏) ----- */ 
        .selection-panel { 
            display: flex; 
            justify-content: space-around; 
            align-items: flex-start; 
            background-color: var(--bg-dark); 
            padding: 15px 10px; 
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4); 
            border-bottom: 1px solid var(--bg-medium); 
        } 

        .selection-item { 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            padding: 5px; 
            width: 30%; 
            text-align: center; 
        } 
         
        /* –°—Ç–∏–ª–∏ Font Awesome –∏–∫–æ–Ω–æ–∫ */ 
        .selection-icon { 
            font-size: 20px; 
            color: var(--secondary-color); 
            margin-bottom: 5px; 
            line-height: 1; 
        } 

        .selection-label { 
            font-size: 11px; 
            color: var(--secondary-color); 
            text-transform: uppercase; 
        } 

        .selection-value { 
            font-size: 14px; 
            font-weight: bold; 
            color: var(--text-main); 
            margin-top: 2px; 
        } 

        /* ----- –§–æ—Ä–º–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ/–û–≤–µ—Ä–ª–µ–π) ----- */ 
        #booking-overlay { 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100vw; 
            height: 100vh; 
            background-color: rgba(0, 0, 0, 0.75); 
            z-index: 999;  
            display: none; 
            justify-content: center; 
            align-items: center; 
        } 

        #booking-form { 
            background-color: var(--bg-medium); 
            border-radius: 12px; 
            padding: 20px; 
            max-width: 350px; 
            width: 90%; 
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.7); 
            color: var(--text-main); 
            position: relative; 
        } 

        #closeBookingForm { 
            position: absolute; 
            top: 10px; 
            right: 15px; 
            font-size: 24px; 
            color: var(--secondary-color); 
            cursor: pointer; 
        } 
         
        #booking-form label { 
            display: block; 
            margin: 8px 0 4px; 
            color: var(--secondary-color); 
            font-size: 12px; 
        } 

        #booking-form input, 
        #booking-form select { 
            width: 100%; 
            padding: 8px; 
            border-radius: 8px; 
            border: 1px solid #444; 
            background-color: #333; 
            color: var(--text-main); 
            font-size: 14px; 
            box-sizing: border-box; 
        } 
         
        #booking-form button[type="submit"] { 
            margin-top: 20px; 
            padding: 12px; 
            background-color: var(--primary-color); 
            color: var(--text-main); 
            font-weight: bold; 
            border: none; 
            border-radius: 8px; 
            cursor: pointer; 
            font-size: 14px; 
            width: 100%; 
            text-transform: uppercase; 
        } 

        /* ----- –ö–∞—Ä—Ç–∞ —Å—Ç–æ–ª–æ–≤ (–≥–ª–∞–≤–Ω—ã–π –±–ª–æ–∫) ----- */ 
        .table-map-container { 
            flex-grow: 1; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            padding: 20px 10px 40px; 
        } 

        .map-wrapper { 
            width: 100%; 
            max-width: 750px;  
            display: flex; 
            justify-content: center; 
            align-items: flex-start; 
            gap: 20px;  
        } 

        .table-map { 
            width: 100%; 
            max-width: 350px; 
            height: 400px;  
            background-color: var(--bg-medium); 
            border-radius: 12px; 
            position: relative; 
            border: 2px solid #555; 
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.5); 
            background-image: linear-gradient(135deg, #444c4c 25%, transparent 25%), 
                                linear-gradient(225deg, #444c4c 25%, transparent 25%), 
                                linear-gradient(45deg, #444c4c 25%, #3E4646 25%), 
                                linear-gradient(315deg, #444c4c 25%, #3E4646 25%); 
            background-size: 20px 20px; 
            background-position: 0 0, 10px 0, 10px -10px, 0px 10px; 
            flex-shrink: 0; 
        } 

        /* –ö–ê–†–¢–û–ß–ö–ê –î–ï–¢–ê–õ–ï–ô –°–¢–û–õ–ê */ 
        #table-details-card { 
            display: none;  
            width: 100%; 
            max-width: 350px; 
            background-color: var(--bg-medium); 
            border-radius: 12px; 
            padding: 15px; 
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.5); 
            border: 2px solid var(--secondary-color); 
            transition: all 0.3s ease-in-out; 
            box-sizing: border-box; 
            flex-shrink: 0; 
        } 

        #table-details-card img { 
            width: 100%; 
            height: auto; 
            border-radius: 8px; 
            margin-bottom: 10px; 
            object-fit: cover; 
            max-height: 200px; 
        } 

        #table-details-card h3 { 
            color: var(--secondary-color); 
            margin: 0 0 5px 0; 
            font-size: 18px; 
        } 

        #table-details-card p { 
            color: var(--text-main); 
            font-size: 14px; 
            line-height: 1.4; 
            margin: 0; 
        } 

        #table-details-card strong { 
            color: var(--secondary-color); 
        } 

        /* –°—Ç–∏–ª–∏ –¥–ª—è –æ–±—â–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ –∫–∞—Ä—Ç–µ (–í—Ö–æ–¥, –ë–∞—Ä) */ 
        .map-feature { 
            position: absolute; 
            text-align: center; 
            font-size: 10px; 
            color: var(--secondary-color); 
            padding: 5px; 
            opacity: 0.7; 
            border-radius: 4px; 
        } 

        /* –ë–∞—Ä–Ω–∞—è —Å—Ç–æ–π–∫–∞ */ 
        #bar-counter { 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 40px; 
            background-color: #4B4F52;  
            border-bottom: 3px solid var(--secondary-color); 
            font-size: 12px; 
            line-height: 30px; 
        } 
         
        /* –í—Ö–æ–¥ */ 
        #entrance { 
            bottom: 0; 
            left: 50%; 
            transform: translateX(-50%); 
            width: 80px; 
            height: 30px; 
            background-color: #555; 
            line-height: 20px; 
            border-top: 2px solid var(--secondary-color); 
            color: var(--text-main); 
            font-weight: bold; 
        } 

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å—Ç–æ–ª–æ–≤ */ 
        .table-element { 
            position: absolute; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            cursor: pointer; 
            transition: background-color 0.3s, border-color 0.3s; 
            font-weight: bold; 
            color: var(--text-main); 
            box-sizing: border-box; 
            font-size: 12px; 
        } 

        /* –°—Ç–∏–ª—å –∫—Ä—É–≥–ª–æ–≥–æ —Å—Ç–æ–ª–∞ */ 
        .table-round { 
            border-radius: 50%; 
        } 

        /* –°—Ç–∏–ª—å –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–æ–≥–æ —Å—Ç–æ–ª–∞ (–¥–ª—è –±–∞–Ω–∫–µ—Ç–æ–∫) */ 
        .table-rect { 
            border-radius: 4px; 
        } 
         
        /* –°—Ç–∏–ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è */ 
        .table-element { 
            background-color: var(--table-free); 
            border: 2px solid var(--secondary-color); 
        } 

        .table-booked { 
            background-color: var(--table-booked) !important; 
            border-color: var(--table-booked) !important; 
            cursor: not-allowed; 
            opacity: 0.8; 
        } 

        .table-selected { 
            background-color: var(--table-selected) !important; 
            border-color: var(--secondary-color) !important; 
            box-shadow: 0 0 10px var(--secondary-color); 
        } 

        /* –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–æ–≤ */ 
        #table-1 { top: 55px; left: 50px; width: 45px; height: 45px; }  
        #table-2 { top: 55px; left: 255px; width: 45px; height: 45px; }  
        #table-3 { top: 120px; left: 10px; width: 80px; height: 50px; }  
        #table-4 { top: 200px; left: 10px; width: 80px; height: 50px; }  
        #table-5 { top: 160px; left: 135px; width: 70px; height: 70px; }  
        #table-6 { top: 160px; right: 10px; width: 80px; height: 80px; border-radius: 6px; }  
        #table-7 { top: 300px; left: 50px; width: 80px; height: 50px; }  
        #table-8 { top: 300px; left: 220px; width: 80px; height: 50px; }  

        /* ----- –ö–Ω–æ–ø–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (–í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ù–ê–Ø, –ë–û–õ–¨–®–ê–Ø) ----- */ 
        #confirm-btn { 
            width: 80%; 
            margin: 20px auto 10px; 
            /* –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π padding –∏ font-size */ 
            padding: 18px;  
            background-color: var(--primary-color); 
            color: var(--text-main); 
            font-size: 18px; /* –°–¥–µ–ª–∞–ª–∏ –∫—Ä—É–ø–Ω–µ–µ */ 
            font-weight: bold; 
            border: none; 
            border-radius: 10px; /* –ë–æ–ª–µ–µ –æ–∫—Ä—É–≥–ª–∞—è */ 
            cursor: pointer; 
            text-transform: uppercase; 
            /* –ë–æ–ª–µ–µ –≤—ã—Ä–∞–∂–µ–Ω–Ω–∞—è —Ç–µ–Ω—å */ 
            box-shadow: 0 6px 15px rgba(140, 120, 81, 0.5);  
            transition: background-color 0.2s, box-shadow 0.2s; 
        } 

        #confirm-btn:hover:not(:disabled) { 
             background-color: #A39169; 
             box-shadow: 0 8px 20px rgba(140, 120, 81, 0.7);  
        } 

        #confirm-btn:disabled { 
            background-color: #666; 
            cursor: not-allowed; 
            box-shadow: none; 
        } 

        .confirmation-text { 
            text-align: center; 
            font-size: 12px; 
            color: var(--secondary-color); 
        } 

        /* --- –°—Ç–∏–ª–∏ –¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏ --- */ 
        @media (max-width: 768px) { 
            .map-wrapper { 
                flex-direction: column; 
                align-items: center; 
            } 
            #table-details-card { 
                margin-top: 20px; 
            } 
        } 
    </style> 
</head> 
<body> 

<div class="header-section"> 
    <div class="header-title">–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –°—Ç–æ–ª–∏–∫</div> 
    <div class="header-subtitle">–†–µ—Å—Ç–æ—Ä–∞–Ω "–ó–æ–ª–æ—Ç–∞—è –õ–æ–∂–∫–∞"</div> 
</div> 

<div class="selection-panel"> 
    <div class="selection-item" id="date-select-trigger"> 
        <span class="selection-icon"><i class="fa fa-calendar"></i></span>  
        <span class="selection-label">–î–∞—Ç–∞</span> 
        <span class="selection-value" id="current-date-value">–°–µ–≥–æ–¥–Ω—è, 4 –æ–∫—Ç 2025</span> 
    </div> 
    <div class="selection-item" id="time-select-trigger"> 
        <span class="selection-icon"><i class="fa fa-clock-o"></i></span>  
        <span class="selection-label">–í—Ä–µ–º—è</span> 
        <span class="selection-value" id="current-time-value">12:30</span> 
    </div> 
    <div class="selection-item" id="guests-select-trigger"> 
        <span class="selection-icon"><i class="fa fa-users"></i></span>  
        <span class="selection-label">–ì–æ—Å—Ç–∏</span> 
        <span class="selection-value" id="current-guests-value">2</span> 
    </div> 
</div> 

<div class="table-map-container"> 
    <div class="map-wrapper"> 
        <div class="table-map" id="table-map"> 
            <div id="bar-counter" class="map-feature">–ë–∞—Ä–Ω–∞—è –°—Ç–æ–π–∫–∞</div> 
            <div id="entrance" class="map-feature">–í—Ö–æ–¥</div> 

            <div class="table-element table-round" id="table-1" data-table="1">1</div> 
            <div class="table-element table-round" id="table-2" data-table="2">2</div> 
            <div class="table-element table-rect" id="table-3" data-table="3">3</div> 
            <div class="table-element table-rect" id="table-4" data-table="4">4</div> 
            <div class="table-element table-round" id="table-5" data-table="5">5</div> 
            <div class="table-element table-rect" id="table-6" data-table="6">6</div> 
            <div class="table-element table-rect" id="table-7" data-table="7">7</div> 
            <div class="table-element table-rect" id="table-8" data-table="8">8</div> 
        </div> 

        <div id="table-details-card"> 
            <img id="table-photo" src="" alt="–§–æ—Ç–æ —Å—Ç–æ–ª–∏–∫–∞" /> 
            <h3 id="table-title"></h3> 
            <p id="table-description"></p> 
        </div> 
    </div> 
     
    <button id="confirm-btn" disabled>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –±—Ä–æ–Ω—å</button> 
    <div class="confirmation-text">–í—ã –ø–æ–ª—É—á–∏—Ç–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Telegram</div> 
</div> 


<div id="booking-overlay"> 
    <form id="booking-form"> 
        <div id="closeBookingForm">&times;</div> 
        <h2>–î–µ—Ç–∞–ª–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</h2> 
         
        <label for="date-modal">–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É</label> 
        <input type="date" id="date-modal" required /> 
         
        <label for="time-modal">–í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è</label> 
        <select id="time-modal" required></select> 
         
        <label for="guests-modal">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ—Å—Ç–µ–π</label> 
        <input type="number" id="guests-modal" min="1" max="20" value="2" required /> 
         
        <label for="phone-modal">–¢–µ–ª–µ—Ñ–æ–Ω</label> 
        <input type="tel" id="phone-modal" placeholder="+7 (XXX) XXX-XX-XX" required /> 
         
        <button type="submit">–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–æ–ª–∏–∫ <span id="selected-table-modal"></span></button> 
        <div id="message"></div> 
    </form> 
</div> 

<script src="https://telegram.org/js/telegram-web-app.js"></script> 
<script> 
    // --- –î–ê–ù–ù–´–ï –û –°–¢–û–õ–ê–• (–û–±–Ω–æ–≤–ª–µ–Ω—ã: –≤—Å–µ —Å—Å—ã–ª–∫–∏ –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ –Ω–æ–≤—ã–π URL) --- 
const tableData = { 
    '1': {  
        name: '–°—Ç–æ–ª–∏–∫ ‚Ññ1 (–£ –ë–∞—Ä–∞)',  
        seats: 2,  
        desc: '–£—é—Ç–Ω—ã–π —Å—Ç–æ–ª–∏–∫ –¥–ª—è –¥–≤–æ–∏—Ö —Å –≤–∏–¥–æ–º –Ω–∞ –±–∞—Ä–Ω—É—é —Å—Ç–æ–π–∫—É. –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –∞–ø–µ—Ä–∏—Ç–∏–≤–∞.', 
        photo_url: 'https://storage.yandexcloud.net/omskinform/files/images-old/restoran_kafe_bokal.jpg' 
    }, 
    '2': {  
        name: '–°—Ç–æ–ª–∏–∫ ‚Ññ2 (–£ –ë–∞—Ä–∞)',  
        seats: 2,  
        desc: '–ù–µ–±–æ–ª—å—à–æ–π –∫—Ä—É–≥–ª—ã–π —Å—Ç–æ–ª –≤–¥–∞–ª–∏ –æ—Ç –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∑–∞–ª–∞. –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è —Å–≤–∏–¥–∞–Ω–∏–π.', 
        photo_url: 'https://storage.yandexcloud.net/omskinform/files/images-old/restoran_kafe_bokal.jpg' 
    }, 
    '3': {  
        name: '–ë–∞–Ω–∫–µ—Ç–∫–∞ ‚Ññ3 (–£ –°—Ç–µ–Ω—ã)',  
        seats: 4,  
        desc: '–ö–æ–º—Ñ–æ—Ä—Ç–Ω—ã–π –¥–∏–≤–∞–Ω –Ω–∞ —á–µ—Ç—ã—Ä–µ—Ö —á–µ–ª–æ–≤–µ–∫. –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω —É —Å—Ç–µ–Ω—ã –¥–ª—è –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏.', 
        photo_url: 'https://storage.yandexcloud.net/omskinform/files/images-old/restoran_kafe_bokal.jpg' 
    }, 
    '4': {  
        name: '–ë–∞–Ω–∫–µ—Ç–∫–∞ ‚Ññ4 (–£ –°—Ç–µ–Ω—ã)',  
        seats: 4,  
        desc: '–£–¥–æ–±–Ω–∞—è –±–∞–Ω–∫–µ—Ç–∫–∞ —Å –º—è–≥–∫–∏–º–∏ —Å–∏–¥–µ–Ω—å—è–º–∏. –û—Ç–ª–∏—á–Ω–æ–µ –º–µ—Å—Ç–æ –¥–ª—è —Å–µ–º–µ–π–Ω–æ–≥–æ —É–∂–∏–Ω–∞.', 
        photo_url: 'https://storage.yandexcloud.net/omskinform/files/images-old/restoran_kafe_bokal.jpg' 
    }, 
    '5': {  
        name: '–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –°—Ç–æ–ª ‚Ññ5',  
        seats: 6,  
        desc: '–ë–æ–ª—å—à–æ–π –∫—Ä—É–≥–ª—ã–π —Å—Ç–æ–ª –≤ —Ü–µ–Ω—Ç—Ä–µ –∑–∞–ª–∞. –ò–¥–µ–∞–ª–µ–Ω –¥–ª—è –±–æ–ª—å—à–∏—Ö –∫–æ–º–ø–∞–Ω–∏–π –∏ —Ç–æ—Ä–∂–µ—Å—Ç–≤.', 
        photo_url: 'https://storage.yandexcloud.net/omskinform/files/images-old/restoran_kafe_bokal.jpg' 
    }, 
    '6': {  
        name: '–°—Ç–æ–ª ‚Ññ6 (–ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–π)',  
        seats: 8,  
        desc: '–°–∞–º—ã–π –±–æ–ª—å—à–æ–π —Å—Ç–æ–ª –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –≤—Å—Ç—Ä–µ—á.', 
        photo_url: 'https://storage.yandexcloud.net/omskinform/files/images-old/restoran_kafe_bokal.jpg' 
    }, 
    '7': {  
        name: '–°—Ç–æ–ª ‚Ññ7 (–£ –í—Ö–æ–¥–∞)',  
        seats: 4,  
        desc: '–ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω—ã–π —Å—Ç–æ–ª–∏–∫, –±–ª–∏–∑–∫–æ –∫ –≤—Ö–æ–¥—É. –•–æ—Ä–æ—à–æ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –æ–±–µ–¥–∞.', 
        photo_url: 'https://storage.yandexcloud.net/omskinform/files/images-old/restoran_kafe_bokal.jpg' 
    }, 
    '8': {  
        name: '–°—Ç–æ–ª ‚Ññ8 (–£ –í—Ö–æ–¥–∞)',  
        seats: 4,  
        desc: '–ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω—ã–π —Å—Ç–æ–ª —Å —Ö–æ—Ä–æ—à–∏–º –æ–±–∑–æ—Ä–æ–º –Ω–∞ –≤—Ö–æ–¥–Ω—É—é –≥—Ä—É–ø–ø—É.', 
        photo_url: 'https://storage.yandexcloud.net/omskinform/files/images-old/restoran_kafe_bokal.jpg' 
    } 
}; 


    // --- –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ DOM —ç–ª–µ–º–µ–Ω—Ç—ã --- 
    let user_id = null; 
    let user_name = null; 
    // –í–ê–ñ–ù–û: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —ç—Ç–∞ URL-–∞–¥—Ä–µ—Å –≤–µ–¥–µ—Ç –Ω–∞ –≤–∞—à —Ä–∞–±–æ—Ç–∞—é—â–∏–π –±—ç–∫–µ–Ω–¥ –±–æ—Ç–∞!
    let botApiUrl = ''; 
    let selectedTable = null; 
     
    const dateInputModal = document.getElementById("date-modal"); 
    const timeSelectModal = document.getElementById("time-modal"); 
    const guestsInputModal = document.getElementById("guests-modal"); 
    const phoneInputModal = document.getElementById("phone-modal"); 
    const confirmBtn = document.getElementById("confirm-btn"); 
    const bookingOverlay = document.getElementById("booking-overlay"); 
    const bookingForm = document.getElementById("booking-form"); 
    const messageDiv = document.getElementById("message"); 
     
    const dateValueDisplay = document.getElementById("current-date-value");  
    const timeValueDisplay = document.getElementById("current-time-value"); 
    const guestsValueDisplay = document.getElementById("current-guests-value"); 

    const tableDetailsCard = document.getElementById("table-details-card"); 
    const tablePhoto = document.getElementById("table-photo"); 
    const tableTitle = document.getElementById("table-title"); 
    const tableDescription = document.getElementById("table-description"); 


    function getQueryParams() { 
        const params = {}; 
        new URLSearchParams(window.location.search).forEach((value, key) => { 
            params[key] = value; 
        }); 
        return params; 
    } 

    function adaptToTheme() { 
        document.documentElement.style.setProperty('color-scheme', 'dark'); 
    } 

    window.onload = function() { 
        const params = getQueryParams(); 
        user_id = params.user_id; 
        user_name = params.user_name; 
        // –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ URL –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –Ω–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
        botApiUrl = params.bot_url || "https://readytoearn-4.onrender.com";  

        if (window.Telegram && window.Telegram.WebApp) { 
            adaptToTheme(); 
            window.Telegram.WebApp.ready(); 
        } 
         
        const now = new Date(); 
        const todayStr = now.toISOString().slice(0, 10); 
         
        dateInputModal.value = todayStr; 
        dateValueDisplay.textContent = formatDateForDisplay(now); 
        guestsValueDisplay.textContent = guestsInputModal.value; 

        fillTimeSelect(null, todayStr);  
    }; 

    function formatDateForDisplay(date) { 
        const today = new Date(); 
        const tomorrow = new Date(today); 
        tomorrow.setDate(today.getDate() + 1); 

        // –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –¥–∞—Ç—ã, –±–µ–∑ –≤—Ä–µ–º–µ–Ω–∏
        const dateOnly = new Date(date.getFullYear(), date.getMonth(), date.getDate());
        const todayOnly = new Date(today.getFullYear(), today.getMonth(), today.getDate());
        const tomorrowOnly = new Date(tomorrow.getFullYear(), tomorrow.getMonth(), tomorrow.getDate());

        if (dateOnly.getTime() === todayOnly.getTime()) { 
            return "–°–µ–≥–æ–¥–Ω—è, " + date.toLocaleDateString('ru-RU', { day: 'numeric', month: 'short' }); 
        } else if (dateOnly.getTime() === tomorrowOnly.getTime()) { 
            return "–ó–∞–≤—Ç—Ä–∞, " + date.toLocaleDateString('ru-RU', { day: 'numeric', month: 'short' }); 
        } else { 
            return date.toLocaleDateString('ru-RU', { weekday: 'short', day: 'numeric', month: 'short' }); 
        } 
    } 


    function generateAllTimeSlots() { 
        const slots = []; 
        let start = new Date(); start.setHours(12, 0, 0, 0);  
        const end = new Date(); end.setHours(23, 0, 0, 0);  
        while (start <= end) { 
            slots.push(start.toTimeString().slice(0, 5)); 
            start = new Date(start.getTime() + 30 * 60000); 
        } 
        return slots; 
    } 

    // –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –≤–µ—Ä–Ω—É—Ç—å —Å–ø–∏—Å–æ–∫ –∑–∞–Ω—è—Ç—ã—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤ –¥–ª—è –î–ê–ù–ù–û–ì–û —Å—Ç–æ–ª–∞ (tableId)
async function fillTimeSelect(tableId, selectedDate) { 
    const select = timeSelectModal; 
    select.innerHTML = ''; 
    select.disabled = true; ¬†
    
    const allSlots = generateAllTimeSlots(); 
    let bookedTimes = []; 
    
    // ==========================================================
    // üëá –ù–û–í–û–ï: –ü–û–õ–£–ß–ê–ï–ú –°–ü–ò–°–û–ö –ó–ê–ù–Ø–¢–´–• –í–†–ï–ú–ï–ù–ù–´–• –°–õ–û–¢–û–í
    // ==========================================================
    try {
        // –ó–∞–ø—Ä–æ—Å –Ω–∞ –±—ç–∫–µ–Ω–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤ –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –¥–∞—Ç—É
        const res = await fetch(`${botApiUrl}/get_booked_times?date=${selectedDate}`);
        const data = await res.json();
        
        if (data.status === 'ok' && Array.isArray(data.booked_times)) {
            // –ú–∞—Å—Å–∏–≤ –∑–∞–Ω—è—Ç—ã—Ö —Å–ª–æ—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, ["12:30", "13:00"])
            bookedTimes = data.booked_times; 
        }
    } catch(err) {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∑–∞–Ω—è—Ç—ã—Ö —Å–ª–æ—Ç–æ–≤ –¥–ª—è –¥–∞—Ç—ã:', err);
    }
    // ==========================================================
    
    const now = new Date(); 
    const todayDateStr = now.toISOString().slice(0, 10); 
    let firstAvailableSlot = null; 

    allSlots.forEach(slot => { 
        // 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—Ä–æ—à–µ–¥—à–µ–µ –≤—Ä–µ–º—è
        let isPast = false; 
        if (selectedDate === todayDateStr) { 
            const slotTime = new Date(`${selectedDate}T${slot}:00`); 
            // –°–ª–æ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ —Ä–∞–Ω—å—à–µ, —á–µ–º —á–µ—Ä–µ–∑ 30 –º–∏–Ω—É—Ç –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
            if (slotTime.getTime() < now.getTime() + 30 * 60000) { 
                isPast = true; 
            } 
        } 
        
        // 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∑–∞–Ω—è—Ç–æ—Å—Ç—å —Å–ª–æ—Ç–∞
        const isBooked = bookedTimes.includes(slot);

        // –î–æ–±–∞–≤–ª—è–µ–º –æ–ø—Ü–∏—é, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤—Ä–µ–º—è –Ω–µ –ø—Ä–æ—à–ª–æ –ò —Å–ª–æ—Ç –Ω–µ –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω
        if (!isPast && !isBooked) { 
            const option = document.createElement("option"); 
            option.value = slot; 
            option.textContent = slot; 
            select.appendChild(option); 
            
            if (!firstAvailableSlot) { 
                firstAvailableSlot = slot; 
            } 
        } 
    }); 
    
    select.disabled = false; 
    if (select.options.length > 0) { 
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–µ—Ä–≤–æ–µ –¥–æ—Å—Ç—É–ø–Ω–æ–µ –≤—Ä–µ–º—è –∫–∞–∫ —Ç–µ–∫—É—â–µ–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–µ
        select.value = firstAvailableSlot; 
        timeValueDisplay.textContent = firstAvailableSlot; 
    } else { 
        // –ï—Å–ª–∏ —Å–ª–æ—Ç–æ–≤ –Ω–µ—Ç, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        select.value = ""; 
        timeValueDisplay.textContent = "–ù–µ—Ç –º–µ—Å—Ç"; 
    } 
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å—Ç–æ–ª–æ–≤ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π –¥–∞—Ç—ã/–≤—Ä–µ–º–µ–Ω–∏
    updateTableAvailability(selectedDate, select.value); // –ü–µ—Ä–µ–¥–∞–µ–º –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
} 
     
    // –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø: –î–æ–±–∞–≤–ª—è–µ—Ç –ª–æ–≥–∏–∫—É –∑–∞–ø—Ä–æ—Å–∞ –∑–∞–Ω—è—Ç—ã—Ö —Å—Ç–æ–ª–æ–≤ —Å –±—ç–∫–µ–Ω–¥–∞
    async function updateTableAvailability(date, time) { 
         
        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ –≤—ã–¥–µ–ª–µ–Ω–∏—è, –Ω–æ –ø–æ–∫–∞ –Ω–µ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å –∑–∞–Ω—è—Ç–æ—Å—Ç–∏, 
        // —Ç–∞–∫ –∫–∞–∫ –æ–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –∏–∑ –±—ç–∫–µ–Ω–¥–∞.
        document.querySelectorAll('.table-element').forEach(table => { 
            table.classList.remove('table-selected'); 
            table.classList.remove('table-booked'); // –°–±—Ä–æ—Å–∏–º, —á—Ç–æ–±—ã –æ–±–Ω–æ–≤–∏—Ç—å –ø–æ –∞–∫—Ç—É–∞–ª—å–Ω—ã–º –¥–∞–Ω–Ω—ã–º
        }); 
         
        let bookedTables = []; 
        // –í–ê–ñ–ù–û: –≠–¢–û–¢ –≠–ù–î–ü–û–ò–ù–¢ (get_all_booked_tables) –î–û–õ–ñ–ï–ù –ë–´–¢–¨ –†–ï–ê–õ–ò–ó–û–í–ê–ù –ù–ê –ë–≠–ö–ï–ù–î–ï! 
        try { 
            const url = `${botApiUrl}/get_all_booked_tables?date=${date}&time=${time}&guests=${guestsInputModal.value}`; 
            // –ó–ê–ì–õ–£–®–ö–ê: –ï—Å–ª–∏ —É –≤–∞—Å –Ω–µ—Ç –±—ç–∫–µ–Ω–¥–∞, —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∫–æ–¥ –Ω–∏–∂–µ, —á—Ç–æ–±—ã –∏–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–Ω—è—Ç—ã–π —Å—Ç–æ–ª:
            /*
            if (date === "2025-10-05" && time === "18:00") {
                bookedTables = ["3", "5"]; 
            }
            */
            const res = await fetch(url); 
            const data = await res.json(); 
            if (data.status === 'ok' && Array.isArray(data.booked_tables)) { 
                bookedTables = data.booked_tables.map(String); // –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ ID - —ç—Ç–æ —Å—Ç—Ä–æ–∫–∏ 
            } 
        } catch (error) { 
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∑–∞–Ω—è—Ç—ã—Ö —Å—Ç–æ–ª–æ–≤:', error); 
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—É—é –∑–∞–≥–ª—É—à–∫—É, –µ—Å–ª–∏ –±—ç–∫–µ–Ω–¥ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
            // bookedTables = ["1", "4"];
        } 
         
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –≤—Å–µ—Ö —Å—Ç–æ–ª–æ–≤ 
        document.querySelectorAll('.table-element').forEach(table => { 
            const tableId = table.dataset.table; 
            if (bookedTables.includes(tableId)) { 
                table.classList.add('table-booked'); 
            } 
        }); 

        // –ü—Ä–æ–≤–µ—Ä–∫–∞, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ä–∞–Ω–µ–µ –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Å—Ç–æ–ª —Ç–µ–ø–µ—Ä—å –∑–∞–Ω—è—Ç—ã–º
        if (selectedTable) { 
            const tableElement = document.getElementById(`table-${selectedTable}`); 
            if (tableElement && tableElement.classList.contains('table-booked')) { 
                // –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Å—Ç–æ–ª —Ç–µ–ø–µ—Ä—å –∑–∞–Ω—è—Ç, —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–±–æ—Ä
                selectedTable = null; 
                confirmBtn.disabled = true; 
                confirmBtn.textContent = '–í—ã–±–µ—Ä–∏—Ç–µ –¥—Ä—É–≥–æ–π —Å—Ç–æ–ª'; 
                tableDetailsCard.style.display = 'none';  
            } else if (tableElement) { 
                // –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Å—Ç–æ–ª —Å–≤–æ–±–æ–¥–µ–Ω, –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ
                tableElement.classList.add('table-selected'); 
                confirmBtn.disabled = false; 
                confirmBtn.textContent = `–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–æ–ª ${selectedTable}`; 
                showTableDetails(selectedTable); 
            } 
        } else { 
            // –ï—Å–ª–∏ —Å—Ç–æ–ª –Ω–µ –≤—ã–±—Ä–∞–Ω, —É–±–µ–¥–∏–º—Å—è, —á—Ç–æ –∫–Ω–æ–ø–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∞
            confirmBtn.disabled = true; 
            confirmBtn.textContent = '–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –±—Ä–æ–Ω—å'; 
            tableDetailsCard.style.display = 'none';  
        } 
    } 

    function showTableDetails(tableId) { 
        const data = tableData[tableId]; 
        if (data) { 
            tablePhoto.src = data.photo_url; 
            tableTitle.textContent = data.name; 
            tableDescription.innerHTML = `<strong>–ú–µ—Å—Ç:</strong> ${data.seats}<br>${data.desc}`; 
            tableDetailsCard.style.display = 'block'; 
        } 
    } 

    document.querySelectorAll('.table-element').forEach(table => { 
        table.addEventListener('click', (e) => { 
            const clickedTable = e.currentTarget.dataset.table; 
             
            if (e.currentTarget.classList.contains('table-booked')) { 
                messageDiv.textContent = '‚ùå –°—Ç–æ–ª–∏–∫ –∑–∞–Ω—è—Ç. –í—ã–±–µ—Ä–∏—Ç–µ –¥—Ä—É–≥–æ–π.'; 
                messageDiv.style.display = 'block'; 
                return; 
            } 
             
            if (selectedTable) { 
                document.getElementById(`table-${selectedTable}`).classList.remove('table-selected'); 
            } 
             
            selectedTable = clickedTable; 
            e.currentTarget.classList.add('table-selected'); 
            confirmBtn.disabled = false; 
            confirmBtn.textContent = `–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–æ–ª ${selectedTable}`; 
            messageDiv.style.display = 'none'; 

            showTableDetails(selectedTable); 
        }); 
    }); 

    confirmBtn.addEventListener('click', () => { 
        if (!selectedTable) return; 
         
        document.getElementById('selected-table-modal').textContent = selectedTable; 
        phoneInputModal.value = '';  
        bookingOverlay.style.display = 'flex'; 
    }); 

    document.getElementById("closeBookingForm").addEventListener('click', () => { 
        bookingOverlay.style.display = 'none'; 
    }); 

    dateInputModal.addEventListener('change', (e) => { 
        const newDate = new Date(e.target.value); 
        dateValueDisplay.textContent = formatDateForDisplay(newDate); 
        // –ü–µ—Ä–µ–¥–∞–µ–º null, —Ç–∞–∫ –∫–∞–∫ –ø—Ä–∏ —Å–º–µ–Ω–µ –¥–∞—Ç—ã –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Å–ª–æ—Ç—ã –∏ —Å—Ç–æ–ª—ã
        fillTimeSelect(null, e.target.value); 
    }); 

    timeSelectModal.addEventListener('change', (e) => { 
        timeValueDisplay.textContent = e.target.value; 
        // –ü—Ä–∏ —Å–º–µ–Ω–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å—Ç–æ–ª–æ–≤
        updateTableAvailability(dateInputModal.value, e.target.value); 
    }); 

    guestsInputModal.addEventListener('change', (e) => { 
        guestsValueDisplay.textContent = e.target.value; 
        // –ü—Ä–∏ —Å–º–µ–Ω–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≥–æ—Å—Ç–µ–π –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å—Ç–æ–ª–æ–≤
        updateTableAvailability(dateInputModal.value, timeSelectModal.value); 
    }); 


    // –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –õ–û–ì–ò–ö–ê: –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ –ø–æ–º–µ—á–∞–µ–º —Å—Ç–æ–ª –∫–∞–∫ –∑–∞–Ω—è—Ç—ã–π –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –±—Ä–æ–Ω–∏.
    bookingForm.addEventListener('submit', async (e) => { 
        e.preventDefault(); 
         
        messageDiv.textContent = ""; 
        messageDiv.style.display = "none"; 
         
        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–ª –º–æ–¥–∞–ª–∫—É, –∞ –≤—Ä–µ–º—è —É–∂–µ –ø—Ä–æ—à–ª–æ
        const selectedDateTime = new Date(`${dateInputModal.value}T${timeSelectModal.value}:00`); 
        const now = new Date(); 
         
        if (selectedDateTime.getTime() < now.getTime() - 60000) { // –î–∞–µ–º 1 –º–∏–Ω—É—Ç—É –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π
            messageDiv.textContent = "‚ùå –ù–µ–ª—å–∑—è –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –ø—Ä–æ—à–µ–¥—à–µ–µ –≤—Ä–µ–º—è"; 
            messageDiv.style.display = "block"; 
            return; 
        } 
         
        const data = { 
            user_id: user_id, 
            user_name: user_name, 
            table: selectedTable, 
            date: dateInputModal.value, 
            time: timeSelectModal.value, 
            guests: guestsInputModal.value, 
            phone: phoneInputModal.value 
        }; 

        try { 
            // –û—Ç–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫—É, —á—Ç–æ–±—ã –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –¥–≤–æ–π–Ω–æ–µ –Ω–∞–∂–∞—Ç–∏–µ
            const submitButton = e.submitter;
            submitButton.disabled = true;
            submitButton.textContent = "–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ...";
            
            const res = await fetch(`${botApiUrl}/book`, { 
                method: "POST", 
                headers: { "Content-Type": "application/json" }, 
                body: JSON.stringify(data) 
            }); 
            const result = await res.json(); 
             
            if (res.ok) { 
                messageDiv.textContent = "‚úÖ –°—Ç–æ–ª–∏–∫ –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω! –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤ Telegram."; 
                 
                // 1. –ú–ì–ù–û–í–ï–ù–ù–û–ï –û–ë–ù–û–í–õ–ï–ù–ò–ï –°–¢–ê–¢–£–°–ê –ù–ê –§–†–û–ù–¢–ï–ù–î–ï 
                const bookedTableElement = document.getElementById(`table-${data.table}`); 
                if (bookedTableElement) { 
                    bookedTableElement.classList.remove('table-selected'); 
                    bookedTableElement.classList.add('table-booked'); 
                } 
                 
                // 2. –°–±—Ä–æ—Å UI 
                selectedTable = null; 
                confirmBtn.disabled = true; 
                confirmBtn.textContent = '–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –±—Ä–æ–Ω—å'; 
                tableDetailsCard.style.display = 'none'; 
                // ----------------------------------------------------- 

                // 3. –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –±–æ—Ç—É –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è 
                window.Telegram.WebApp.sendData(JSON.stringify(data)); 
                 
                // 4. –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
                setTimeout(() => { 
                    bookingOverlay.style.display = "none"; 
                }, 2000); 

            } else { 
                messageDiv.textContent = `‚ùå –û—à–∏–±–∫–∞: ${result.message || '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å. –í–æ–∑–º–æ–∂–Ω–æ, —Å—Ç–æ–ª —Ç–æ–ª—å–∫–æ —á—Ç–æ –∑–∞–Ω—è–ª–∏.'}`; 
                submitButton.disabled = false; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å
                submitButton.textContent = "–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–æ–ª–∏–∫ " + data.table;
            } 
            messageDiv.style.display = "block"; 
        } catch (err) { 
            console.error('Fetch error:', err); 
            messageDiv.textContent = "‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ."; 
            messageDiv.style.display = "block"; 
            e.submitter.disabled = false;
            e.submitter.textContent = "–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–æ–ª–∏–∫ " + data.table;
        } 
    }); 
</script> 
</body> 
</html>